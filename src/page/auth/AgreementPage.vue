<template>
  <div class="container">
    <mt-header class="header" :title="title">
      <header-item slot="left" v-bind:isClose="true" v-on:onclick="goBack"></header-item>
    </mt-header>
    <div class="content">
      <div class="agreement-content-container">
        <div class="agreement-content">
          <h2>换换商城平台<br />债权兑换权益积分服务协议</h2>
          <div class="agreement-people">
            <p>用户（以下简称“甲方”）：</p>
          </div>
          <div class="agreement-people">
            <p>电商服务平台（以下简称“乙方”或“换换商城”）：</p>
          </div>
          <section class="agreement-given">
            <p class="title">鉴于：</p>
            <p>
              1、用户欲将其通过安投融（北京）网络科技有限公司运营管理的互联网金融服务平台——爱投资（域名：https://www.itouzi.com）拥有的债权转让给受让方，受让方以与转让债权等值的权益积分受让用户债权；
            </p>
            <p>
              2、权益积分是换换商城（运营商：换东换西（北京）信息技术有限公司）依据商家的让利定制营销策略而通用的商城购物积分，用户可用于购物时抵消部分现金货款；
            </p>
            <p>
              3、换换商城为促进债权转让行为的完成，明确权益消费过程中的法律变动，更好的提供权益消费电商服务，在用户使用换换商城过程中提供权益积分兑换、使用交易、账户查询等服务。
            </p>
            <p class="mgt-10">
              根据《中华人民共和国电商法》及相关法律法规规定，现就换换商城向用户提供
              <span class="bold">债权兑换权益积分服务</span>
              事宜，经甲乙双方协商一致，在平等自愿、诚实信用的基础下达成如下条款：
            </p>
            <p>
              一、鉴于本协议中所述的和本协议相关的内容，均详见用户和受让方签署的《债权转让协议》、换换商城和商家签署的《商家入驻及经营协议》、《商家联盟管理委托服务协议》等。
            </p>
            <p>
              二、本协议是在用户与受让方签订《债权转让协议》成立的基础上，由换换商城提供权益积分服务事宜而签署并适用的配套协议。为了更好的服务债权转让、权益积分兑换等事宜，用户您授权并同意爱投资平台通过合法、安全的技术方式将用户您的个人信息对接于换换商城使用。换换商城的使用用途仅限于本协议和相关协议的约定。
            </p>
            <p>
              三、为了债权转让、权益积分兑换、权益消费的进行，用户需在换换商城平台开设账户，换换商城需同意用户使用其在爱投资平台注册的手机号码进行注册及后续验证流程。用户应当审慎保管、使用前述手机号码，通过前述手机号码及验证号码登录换换商城的，视为用户本人的登录行为。
            </p>
            <p>
              四、本协议中当用户登录换换商城时授权并同意换换商城可获取用户的信息类型，包括但不限于：
            </p>
            <p class="no-mgt">
              1、用户个人信息（如：姓名、联系方式、电子邮箱等）；
            </p>
            <p class="no-mgt">
              2、用于用户身份识别的信息（如：身份证号码、护照号码、驾驶证号码等）；
            </p>
            <p class="no-mgt">
              3、财务信息（如：XX账号、银行卡号/账号、拥有债权的金额、债权交易明细等）。
            </p>
            <p>
              五、甲方在换换商城平台通过网络页面点击确认的方式接受本协议，并同意接受本协议全部约定内容及与本协议有关的各项规则、页面展示、操作流程、公告或通知等，表示用户同意并允许换换商城通过相应程序执行债权转让行为。
            </p>
            <p>
              六、受让方以受让债权等额的权益积分和¥0.01元作为支付对价；故当用户登录换换商城欲完成债转的过程中，换换商城需即时告知用户，受让方欲用受让债权等额的权益积分和¥0.01元受让用户债权，并协助用户完成《债权转让协议》的签署。
            </p>
            <p>
              七、用户使用电子签章签署债权转让协议后，受让方应当根据本协议和《债权转让协议》的约定，委托换换商城将与转让债权金额等额的权益积分发送至用户在换换商城开设的账户内，供用户自由使用。
            </p>
            <p>
              八、当用户的权益积分账户收到与转让债权等额的权益积分以及爱投资账户收到¥0.01元时，视为受让方的支付义务已经充分、完整、及时地履行，即债权转让行为完成，用户丧失债权所有权。债权转让行为的完成不以用户是否用权益积分兑换商品为准。
            </p>
            <p>
              九、用户可在换换商城平台使用权益积分进行现金支付抵扣，以此获得商品或服务（统称：商品）；换换商城需对销售商品标注可使用抵扣的权益积分额度以便用户进行后续交易。
            </p>
            <p>
              十、用户在换换商城平台选择商品时以点击下单、填写订单信息的方式进行交易，并根据商品标注的权益积分信息，使用其账户持有的权益积分进行支付抵扣。其中：
            </p>
            <p class="no-mgt">
              1、用户持有的权益积分不足支付的，用户有权在符合爱投资平台规则及换换商城规则的情况下，自愿完成债权转让行为（用户每次完成债权转让行为时均产生对应的《债权转让协议》）。换换商城应协助用户完成债权转让行为及再次兑换权益积分以便用户可足额支付。
            </p>
            <p class="no-mgt">
              2、用户持有的权益积分不足支付的，且持有债权不足以再次发起债权转让的，用户可以根据换换商城的支付规则，另行采用现金+权益积分支付。
            </p>
            <p>
              十一、<span class="bold"
                >用户同意并认可本协议约定的债权转让及权益积分兑换行为一经生效不可撤销，用户不得擅自退回积分。</span
              >因用户未能消费或者没有消费权益积分，或者因在换换商城进行买卖、商品物流运输、商品质量等交易过程中所产生的纠纷，为新的法律关系纠纷与本协议无关。
            </p>
            <p>
              十二、换换商城在服务用户与受让方的债权转让完成过程中，用户每次兑换权益积分时，在用户同意并授权的情况下，爱投资平台根据与换换商城签署的合作协议，将用户的数据和信息归档传输至换换商城，以便换换商城服务用户和受让人完成债权转让。
            </p>
            <p>
              十三、就本协议涉及的债权兑换权益积分及后续流程，换换商城会根据实际运营情况在其平台配注相应流程细节图解，作为对本协议内容的解释和附注，用户应自行前往了解。本协议内容约定不明的按图解为准。
            </p>
            <p>
              十四、<span class="bold"
                >为了更好地为债权转让主体提供服务，用户有义务按照换换商城的平台软件要求操作及查收换换商城发出的指示信息，因用户个人操作不当致使平台指令错误，由此产生的一切纠纷及法律责任由用户自行承担，换换商城对此不承担任何法律责任。</span
              >
            </p>
            <p>
              十五、用户授权同意换换商城有权对本协议内容进行单方面的变更，并在平台网站页面公示通知。用户应认真阅读、充分理解本协议各条款及对换换商城具有或可能具有免责或限制责任的条款；若用户在本协议内容变更生效后继续使用本服务的，表示其已充分阅读、理解并接受变更修改后的协议内容，也将遵循变更修改后的协议内容；若无法准确理解相关条款含义的或不同意变更修改后的协议内容，请不要进行后续操作并停止使用本服务。
            </p>
            <p>
              十六、用户及换换商城均应具有完全民事行为能力，双方实施本协议项下行为的意思表示真实，不具有欺诈、胁迫、乘人之危及损害国家、集体、他人的合法利益，亦不具有以合法形式掩盖非法的目的。
            </p>
            <p>
              十七、用户及受让人同意并确认，其通过各自账户采取的行为所产生的法律效果和法律责任归属于各自本身，其授权根据本协议及其他所采取的全部行动和措施的法律后果均归属于各自本身。
            </p>
            <p>
              十八、本协议约定，用户承诺同意将通过网络页面点击确认的方式签订本服务协议，并不以此为由拒绝履行本协议项下的义务。用户及换换商城均认可本协议约定的签署方式、协议内容以及认可该形式的合同效力。
            </p>
            <p>
              十九、用户及换换商城在履行本协议的过程中，如发生争议，应协商解决。协商不成的，任何一方均可向本协议签订地（北京市海淀区）有管辖权的人民法院提起诉讼。如因本协议争议而发生诉讼，在诉讼期间本协议不涉及争议部分的条款仍须履行。
            </p>
            <p>
              二十、本协议为线上电子协议，换换商城平台应合法、有效的进行保存。本电子协议具有《中华人民共和国合同法》规定的法律效力。
            </p>
          </section>
        </div>
        <div class="gradient bottom"></div>
      </div>
      <div class="button-wrapper">
        <button @click="goAuth">同意并签署</button>
      </div>
    </div>
  </div>
</template>
<script>
import { mapMutations, mapState } from 'vuex'
import { HeaderItem } from '../../components/common'
import { Header } from 'mint-ui'
import { saveAgreement } from '../../api/auth-base'
export default {
  name: 'agreementPage',
  data() {
    return {
      isFromAuthManage: false //是否从授权管理页面进入
    }
  },
  computed: {
    ...mapState({
      old_id_check_status: state => state.itouzi.old_id_check_status //原授权认证状态
    }),
    title() {
      return this.old_id_check_status || this.isFromAuthManage ? '签署协议' : '第1步 签署协议'
    }
  },
  beforeRouteEnter(to, from, next) {
    next(vm => {
      if (from['name'] === 'AuthManage') {
        vm.isFromAuthManage = true
      }
    })
  },
  methods: {
    ...mapMutations({
      saveAuthAgreement: 'saveAuthAgreement'
    }),
    goBack() {
      if (this.isFromAuthManage) {
        this.$_goBack()
      } else if (this.old_id_check_status) {
        this.$_goBack()
      } else {
        this.$router.go(-2)
      }
    },
    goAuth() {
      this.$indicator.open()
      saveAgreement()
        .then(res => {
          this.saveAuthAgreement({ auth_agreement: 1 })
          //从用户中心设置过来的直接回去
          if (this.isFromAuthManage) {
            this.goBack()
            return
          }
          // 进入第二步【身份验证】
          if (this.old_id_check_status) {
            // 如果身份验证已通过
            this.goBack()
            return
          }
          // 去 身份验证
          this.$router.push({ name: 'AuthFirstStepResult' })
        })
        .finally(() => {
          this.$indicator.close()
        })
    }
  }
}
</script>

<style lang="scss" scoped>
.container {
  height: 100%;
  background: #fff;
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.content {
  flex: 1 0 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 0 20px;

  .button-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px 0;
    button {
      width: 327px;
      height: 46px;
      color: #fff;
      font-size: 18px;
      line-height: 25px;
      background-color: $primaryColor;
      border-radius: 2px;
      border: none;
      outline: none;
    }
  }
}
.agreement-content-container {
  flex: 1 0 0;
  overflow: hidden;
  background: #ffffff;
  display: block;
  position: relative;
  width: 100%;

  .gradient {
    position: absolute;
    box-sizing: border-box;
    width: 100%;
    &.top {
      height: 30px;
      top: 0;
      background: linear-gradient(to top, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 75%);
    }
    &.bottom {
      height: 30px;
      bottom: 0;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%);
    }
  }
}

.agreement-content {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  box-sizing: border-box;
  padding: 0 5px 30px;
  line-height: 1.7;
  font-size: 0.7rem;
  text-align: justify;
  color: #888;
  h2 {
    font-size: 19px;
    color: #000;
    line-height: 26px;
    margin-top: 25px;
    margin-bottom: 20px;
    text-align: center;
  }

  .agreement-people,
  .agreement-given {
    margin-bottom: 0.7rem;
  }
  .agreement-given {
    p {
      text-indent: 2em;
      margin-top: 4px;

      &.no-mgt {
        margin-top: 0;
      }
    }
    .title,
    .no-indent {
      text-indent: 0;
    }
  }
  section.content {
    margin-bottom: 0.7rem;
    h3.content-title {
      font-size: 0.75rem;
      color: #333333;
      margin-bottom: 0.7rem;
    }
    p {
      margin-bottom: 0.2rem;
    }
  }
  section.agreement-bottom {
    &.right-align {
      text-align: right;
      margin: 1rem 0;
    }
    .right-para {
      display: inline-block;
      text-align: left;
      padding-right: 0.5rem;
    }
    p {
      margin-bottom: 1rem;
      &.text-right {
        text-align: right;
      }
    }
  }
}

h3.title {
  font-size: 0.7rem;
  color: #333333;
  margin: 0.5rem 0 0.7rem;
}

section {
  .info,
  .son {
    text-indent: 1rem;
  }
}
.bold {
  font-weight: bold;
}
.mgt-10 {
  margin-top: 10px;
}
</style>
